
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Technical documentation for the CafeSentinel network monitoring system">
      
      
      
      
        <link rel="prev" href="../features/">
      
      
      
        
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>Deployment - CafeSentinel Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.618322db.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#deployment-build" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="CafeSentinel Documentation" class="md-header__button md-logo" aria-label="CafeSentinel Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            CafeSentinel Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Deployment
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="CafeSentinel Documentation" class="md-nav__button md-logo" aria-label="CafeSentinel Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    CafeSentinel Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../monitoring/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Monitoring
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../configuration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Configuration
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../security/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Security
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../logging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Logging
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../features/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Features
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Deployment
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Deployment
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#build-system" class="md-nav__link">
    <span class="md-ellipsis">
      
        Build System
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Build System">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#compilation-process" class="md-nav__link">
    <span class="md-ellipsis">
      
        Compilation Process
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deployment-structure" class="md-nav__link">
    <span class="md-ellipsis">
      
        Deployment Structure
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nuitka-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      
        Nuitka Configuration
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#startup-registration" class="md-nav__link">
    <span class="md-ellipsis">
      
        Startup Registration
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Startup Registration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#automatic-startup" class="md-nav__link">
    <span class="md-ellipsis">
      
        Automatic Startup
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alternative-methods" class="md-nav__link">
    <span class="md-ellipsis">
      
        Alternative Methods
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dependencies" class="md-nav__link">
    <span class="md-ellipsis">
      
        Dependencies
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Dependencies">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#python-packages" class="md-nav__link">
    <span class="md-ellipsis">
      
        Python Packages
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build-dependencies" class="md-nav__link">
    <span class="md-ellipsis">
      
        Build Dependencies
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#system-requirements" class="md-nav__link">
    <span class="md-ellipsis">
      
        System Requirements
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resource-management" class="md-nav__link">
    <span class="md-ellipsis">
      
        Resource Management
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Resource Management">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#path-resolution" class="md-nav__link">
    <span class="md-ellipsis">
      
        Path Resolution
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#build-system" class="md-nav__link">
    <span class="md-ellipsis">
      
        Build System
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Build System">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#compilation-process" class="md-nav__link">
    <span class="md-ellipsis">
      
        Compilation Process
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deployment-structure" class="md-nav__link">
    <span class="md-ellipsis">
      
        Deployment Structure
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nuitka-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      
        Nuitka Configuration
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#startup-registration" class="md-nav__link">
    <span class="md-ellipsis">
      
        Startup Registration
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Startup Registration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#automatic-startup" class="md-nav__link">
    <span class="md-ellipsis">
      
        Automatic Startup
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alternative-methods" class="md-nav__link">
    <span class="md-ellipsis">
      
        Alternative Methods
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dependencies" class="md-nav__link">
    <span class="md-ellipsis">
      
        Dependencies
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Dependencies">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#python-packages" class="md-nav__link">
    <span class="md-ellipsis">
      
        Python Packages
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build-dependencies" class="md-nav__link">
    <span class="md-ellipsis">
      
        Build Dependencies
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#system-requirements" class="md-nav__link">
    <span class="md-ellipsis">
      
        System Requirements
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resource-management" class="md-nav__link">
    <span class="md-ellipsis">
      
        Resource Management
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Resource Management">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#path-resolution" class="md-nav__link">
    <span class="md-ellipsis">
      
        Path Resolution
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="deployment-build">Deployment &amp; Build</h1>
<h2 id="build-system">Build System</h2>
<h3 id="compilation-process">Compilation Process</h3>
<p>Uses Nuitka to compile Python source to native Windows executable.</p>
<p><strong>Build Script:</strong> <code>build.py</code></p>
<p><strong>Build Modes:</strong></p>
<p><strong>Fast Mode:</strong>
- No LTO (Link Time Optimization)
- Console window visible for debugging
- Faster compilation (minutes vs hours)
- Larger executable size
- Used during development</p>
<p><strong>Production Mode:</strong>
- Enables LTO for optimization
- Console window hidden
- Slower compilation (1-2 hours)
- Smaller executable, faster runtime
- Used for deployment</p>
<p><strong>Build Process:</strong>
1. Compile Qt resource file (<code>resources.qrc</code>) to <code>resources_rc.py</code>
2. Run Nuitka on <code>interface.py</code> to create CafeSentinel.exe
3. Run Nuitka on <code>watchdog_service.py</code> to create SentinelService.exe
4. Create nested folder structure for deployment
5. Copy both executables and support files to output directory</p>
<h3 id="deployment-structure">Deployment Structure</h3>
<pre><code>dist/CafeSentinelDeploy/CafeSentinel/
├── CafeSentinel.exe              # Main application
├── install_monitor.bat           # Startup registration script
└── SentinelService/
    └── SentinelService.exe       # Watchdog process
</code></pre>
<p><strong>Generated at Runtime:</strong>
- <code>cscf.dll</code> (encrypted config)
- <code>cron.dll</code> (encrypted passwords)
- <code>info.log</code> (current day log)
- <code>probes/</code> (archived logs with retention cleanup)
- <code>config_backups/</code> (encrypted config backups)</p>
<h3 id="nuitka-configuration">Nuitka Configuration</h3>
<p>Key compilation flags:
- <code>--standalone</code>: Includes all dependencies
- <code>--onefile</code>: Single executable (or separate for two processes)
- <code>--windows-disable-console</code>: Hides console in production
- <code>--enable-plugin=pyside6</code>: Bundles PySide6 framework
- <code>--lto=yes</code>: Link Time Optimization (production only)</p>
<h2 id="startup-registration">Startup Registration</h2>
<h3 id="automatic-startup">Automatic Startup</h3>
<p><strong>install_monitor.bat:</strong>
- Registers SentinelService.exe in Windows Task Scheduler
- Configured to run at user logon
- Runs with highest privileges (admin)
- Persistent across reboots</p>
<p><strong>Task Scheduler Configuration:</strong>
- Trigger: At logon of specific user
- Action: Start program (SentinelService.exe)
- Run with highest privileges: Enabled
- Run whether user is logged on or not: Enabled</p>
<p><strong>Startup Sequence:</strong>
1. Windows boots
2. User logs in
3. Task Scheduler starts SentinelService.exe (watchdog)
4. Watchdog detects CafeSentinel.exe not running
5. Watchdog launches CafeSentinel.exe
6. Main application starts monitoring and initializes logging system
7. Log retention cleanup executes on startup
8. Both processes enter mutual monitoring loop</p>
<h3 id="alternative-methods">Alternative Methods</h3>
<p><strong>Registry Run Key (Optional):</strong>
- Add SentinelService.exe to <code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run</code>
- Starts at user logon without Task Scheduler
- Less reliable for admin privileges</p>
<p><strong>Manual Execution:</strong>
- User double-clicks SentinelService.exe
- Watchdog starts and launches main application
- Requires manual intervention after each reboot</p>
<h2 id="dependencies">Dependencies</h2>
<h3 id="python-packages">Python Packages</h3>
<p><strong>Core Framework:</strong>
- <code>PySide6</code> (6.x): Qt framework for GUI, threading, signals
- <code>requests</code> (2.x): HTTP client for Discord webhooks and API client</p>
<p><strong>Monitoring:</strong>
- <code>mss</code> (9.x): Multi-monitor screenshot capture library
- <code>Pillow</code> (10.x): Image processing for screenshot resizing and format conversion</p>
<p><strong>Server:</strong>
- <code>Flask</code> (3.x): REST API web framework
- <code>flask-cors</code> (4.x): Cross-Origin Resource Sharing support</p>
<p><strong>Security:</strong>
- <code>cryptography</code> (41.x): Fernet encryption for config and password vault</p>
<h3 id="build-dependencies">Build Dependencies</h3>
<ul>
<li><code>Nuitka</code> (1.8.x): Python to C compiler</li>
<li><code>zstandard</code>: Compression library for Nuitka</li>
<li><code>ordered-set</code>: Nuitka internal dependency</li>
</ul>
<h3 id="system-requirements">System Requirements</h3>
<p><strong>Operating System:</strong>
- Windows 10 or Windows 11
- 64-bit architecture required</p>
<p><strong>Privileges:</strong>
- Administrator rights mandatory
- Required for raw ICMP sockets
- Auto-elevation on startup if not running as admin</p>
<p><strong>Runtime:</strong>
- Python 3.10+ (for development)
- Compiled executable requires no Python installation</p>
<p><strong>Network:</strong>
- Local network connectivity for PC monitoring
- Internet access for Discord notifications (optional)
- Open port 5000 for API server (for Manager connectivity)</p>
<h2 id="resource-management">Resource Management</h2>
<h3 id="path-resolution">Path Resolution</h3>
<p><strong>ResourceManager (utils/resource_manager.py):</strong></p>
<p>Handles path differences between script mode and compiled executable.</p>
<p><strong>Detection Logic:</strong>
- Checks for <code>sys.frozen</code> attribute (PyInstaller)
- Checks for <code>__compiled__</code> module (Nuitka)
- Returns appropriate base directory based on mode</p>
<p><strong>Path Resolution:</strong>
- Script mode: Returns script file directory
- Compiled mode: Returns executable directory
- Ensures config, logs, and other files written to correct location</p>
<p><strong>Usage Pattern:</strong></p>
<pre><code>config_path = ResourceManager.get_resource_path(&quot;cscf.dll&quot;)
log_path = ResourceManager.get_resource_path(&quot;info.log&quot;)
</code></pre>
<p>All file operations in application use ResourceManager for path resolution.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "..", "features": [], "search": "../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.e71a0d61.min.js"></script>
      
    
  </body>
</html>